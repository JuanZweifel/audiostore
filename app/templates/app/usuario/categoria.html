{% extends '../usuario/plantillabusqueda.html' %}
{% load static %}

{% block title %}

{% endblock title %}



{% block head %}
<link rel="stylesheet" href="{% static 'app/css/categoria.css' %}">
<script src="{% static 'app/' %}js/categoria.js"></script>
{% endblock head %}


{% block body %}

<div class="container-fluid">
    {% comment %} <form method="GET" action="{% url 'categoria' %}">
        {% csrf_token %} {% endcomment %}
        {% comment %} <div>
            <label for="{{ form.busqueda.id_for_label }}">Búsqueda:</label>
            {{ form.busqueda }}
        </div> {% endcomment %}
        {% comment %} <div>
            <label for="{{ form.categoria.id_for_label }}">Categoría:</label>
            {{ form.categoria }}
        </div> {% endcomment %}
        {% comment %} <button type="submit">Buscar</button> {% endcomment %}



        <div class="row">
            <!-- Filtro -->
            <div class="col-lg-3 col-md-3 col-sm-12">
                <div class="card mt-2">
                    <div class="card-body">
                        <h4 class="card-title"><i class="fa-solid fa-filter"></i> Filtros</h4>
                        <hr>
                        <p class="card-text">
                            <label for="rangePrecio" class="form-label">Precio</label>
                            <input type="range" class="form-range" id="rangePrecio" min="0" max="999999">
                        <div class="dropdown">
                            <button class="btn btn-primary w-100 text-start" type="button" id="dropdownMarcaButton"
                                data-bs-toggle="dropdown" aria-expanded="false">
                                Marcas <i class="fa-solid fa-caret-down float-end lh-base"></i>
                            </button>
                            <ul class="dropdown-menu w-100" aria-labelledby="dropdownMarcaButton">
                                
                                <li><a class="dropdown-item" href="#">Marca 1</a></li>
                                <li><a class="dropdown-item" href="#">Marca 2</a></li>
                                <li><a class="dropdown-item" href="#">Marca 3</a></li>
                            </ul>
                        </div>
                        <hr>
                        <div class="dropdown">
                            <button class="btn btn-primary w-100 text-start" type="button" id="dropdownCategoriaButton"
                                data-bs-toggle="dropdown" aria-expanded="false">
                                Categoria <i class="fa-solid fa-caret-down float-end lh-base"></i>
                            </button>
                            <ul class="dropdown-menu w-100" type="submit" aria-labelledby="dropdownCategoriaButton">
                                {% for opcion_value, opcion_label in form.categoria.field.choices %}
                                <button type="submit" class="dropdown-item" name="categoria"
                                    id="categoria_{{ opcion_value }}" value="{{ opcion_value }}">
                                    {{ opcion_label }}
                                </button>
                                {% endfor %}
                            </ul>
                        </div>
                        {% comment %} <div>
                            <label for="{{ form.categoria.id_for_label }}">Categoría:</label>
                            {{ form.categoria}}
                        </div>
                        <div>
                            <label for="{{ form.marca.id_for_label }}">Marca:</label>
                            {{ form.marca }}
                        </div> {% endcomment %}

                        <div>
                            <label for="{{ form.categoria.id_for_label }}">Categoría:</label>
                            {{ form.categoria }}
                        </div>
                        <div>
                            <label for="{{ form.marca.id_for_label }}">Marca:</label>
                            {{ form.marca }}
                        </div>

                        </p>
                    </div>
                </div>
            </div>
            <!---->
            <div class="col-lg-9 col-md-9 col-sm-12">
                <div id="productos">
                    <div class="row">
                        {% for producto in productos %}
                        <div class="col-lg-3 col-md-6">
                            <a href="{% url 'detalle_producto' producto.id_producto %}">
                                <div class="card mt-2 cardproduct">
                                    <img src="media/{{producto.imagen}}" class="card-img-top" alt="N/A">
                                    <div class="card-body cardp">
                                        <h3 class="card-title text-center"
                                            style="text-overflow: ellipsis; overflow: hidden;">{{producto.nom_producto}}
                                        </h3>
                                        <p class="card-subtitle text-center"
                                            style="text-overflow: ellipsis; overflow: hidden;">{{producto.marca}}</p>
                                        <hr class="my-2" />
                                        <p class="card-text text-center">{{producto.precio}}</p>
                                    </div>
                                </div>
                            </a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

{% block script %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var categoriaSelect = document.getElementById('{{ form.categoria.auto_id }}');
        var marcaSelect = document.getElementById('{{ form.marca.auto_id }}');

        categoriaSelect.addEventListener('change', function () {
            document.getElementById('fprincipal').submit();
        });

        marcaSelect.addEventListener('change', function () {
            document.getElementById('fprincipal').submit();
        });
    });
</script>
{% endblock script %}

{% endblock body %}